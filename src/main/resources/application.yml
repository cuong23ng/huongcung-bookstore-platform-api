#   Database Configuration
# Note: If you encounter foreign key constraint errors, the DatabaseCleanupConfig
# component will automatically clean up orphaned data on startup.
spring:
  jpa:
    hibernate:
      ddl-auto: update
    show-sql: true
  datasource:
    driver-class-name: ${JDBC_DATABASE_DRIVER:com.mysql.cj.jdbc.Driver}
    url: jdbc:mysql://${JDBC_DATABASE_HOST:}:${JDBC_DATABASE_PORT:}/${JDBC_DATABASE_NAME:}?useSSL=false&serverTimezone=UTC&allowPublicKeyRetrieval=true
    username: ${JDBC_DATABASE_USERNAME:}
    password: ${JDBC_DATABASE_PASSWORD:}
  cache:
    type: simple
    cache-names:
      - searchResults
      - searchFacets
      - searchSuggestions

# Server Configuration
server:
  port: 8082
  # Uncomment below for HTTPS (requires SSL certificate)
  # ssl:
  #   enabled: true
  #   key-store: classpath:keystore.p12
  #   key-store-password: password
  #   key-store-type: PKCS12

# JWT Configuration
jwt:
  secret: ${JWT_SECRET:myVerySecureSecretKeyForJWTTokenGenerationThatIsLongEnoughForHS512AlgorithmAndContainsAtLeast64Characters}
  expiration: ${JWT_EXPIRATION:86400000}

# MinIO S3
s3:
  endpoint: ${S3_ENDPOINT}
  bucket: ${S3_BUCKET}
  accessKey: ${S3_ACCESS_KEY}
  secretKey: ${S3_SECRET_KEY}

# Solr Configuration
solr:
  host: ${SOLR_HOST:localhost}
  port: ${SOLR_PORT:8983}
  core: ${SOLR_CORE_NAME:books}
  connection-timeout: 5000
  socket-timeout: 10000
  indexing:
    batch-size: ${SOLR_INDEXING_BATCH_SIZE:1000}
    enabled: ${SOLR_INDEXING_ENABLED:true}
    retry:
      max-attempts: ${SOLR_INDEXING_RETRY_MAX_ATTEMPTS:3}
      delay-ms: ${SOLR_INDEXING_RETRY_DELAY_MS:1000}

# GHN API Configuration
ghn:
  api-token: ${GHN_API_TOKEN}
  base-url: ${GHN_BASE_URL}
  shop-id: ${GHN_SHOP_ID:}
  client-id: ${GHN_CLIENT_ID:}
  timeout: ${GHN_TIMEOUT:10000}
  retry-max-attempts: ${GHN_RETRY_MAX_ATTEMPTS:3}
  retry-delay-ms: ${GHN_RETRY_DELAY_MS:1000}